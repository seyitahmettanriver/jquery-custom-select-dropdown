<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Dropdown Plugin</title>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
        }

        .custom-select-container .custom-select-dropdown {
    position: relative;
    display: inline-block;
}
.custom-select-container .custom-select-label {
    top: -0.5rem;
    left: 0.8rem;
    font-size: .75rem;
    z-index: 10;
    position: absolute;
    padding: 0 0.25rem;
    background-color: #fff;
    color: #5f6368;
    transition: 150ms cubic-bezier(0.4,0,0.2,1);
    pointer-events: none;
}
.custom-select-container .custom-select-toggle {
    cursor: pointer;
    background-color: #fff;
    color: #5f6368;
    width: auto;
    box-sizing: border-box;
    display: flex;
    align-items: center;
    position: relative;
    height: 42px;
    padding: 0.5rem 1rem;
    border: 1.5px solid #dadce0;
    border-radius: 1.5rem;
}
.custom-select-container .custom-select-toggle .selected-image {
    margin-right: 10px;
    pointer-events: none;
}
.custom-select-container .custom-select-menu {
    display: none;
    position: absolute;
    background-color: #fff;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    padding: 0.5rem 0;
    z-index: 1000;
    width: 100%;
    box-sizing: border-box;
    border: 1.5px solid #dadce0;
    border-radius: 0 0 1.5rem 1.5rem;
    border-top: 0;
    overflow: hidden;
}
.custom-select-container .custom-select-menu ul {
    list-style: none;
    margin: 0;
    padding: 0;
}
.custom-select-container .custom-select-menu li {
    padding: 0.25rem 1rem;
    cursor: pointer;
    display: block;
    list-style: none;
    user-select: none;
    position: relative;
}
.custom-select-container .custom-select-menu li:hover {
    background-color: #f9fbff;
}
.custom-select-container .custom-select-menu li {
    display: flex;
    align-items: center;
    padding: 0.25rem 1rem;
    cursor: pointer;
    list-style: none;
    user-select: none;
    position: relative;
}
.custom-select-container .custom-select-menu li img {
    width: 30px;
    height: 30px;
    margin-right: 10px;
    border-radius: 50%;
}
.custom-select-container .custom-select-menu li:hover {
    background-color: #e9ecef;
}
.custom-select-container .custom-select-menu li.active {
    color: #fff;
    text-decoration: none;
    background-color: #35c10d;
}
.custom-select-container .filter-container {
    padding: 4px 8px;
}
.custom-select-container .filter-container .filter-input {
    font-size: .95rem;
    width: 100%;
    box-sizing: border-box;
    border-radius: 4px;
    height: 35px;
    margin-bottom: .3rem;
    color: #5f6368;
    position: relative;
    padding: 0.5rem;
    border: 1.5px solid #dadce0;
}
.custom-select-container .action-buttons {
    display: flex;
    justify-content: space-between;
    padding: 4px 8px;
    gap: 5px;
}
.custom-select-container .action-buttons button {
    cursor: pointer;
    border: none;
    padding: 0.25rem 0.5rem;
    font-size: .875rem;
    line-height: 1.5;
    border-radius: 0.2rem;
    flex: 1;
}
.custom-select-container {
    position: relative;
    user-select: none;
}
.custom-select-container.show .custom-select-toggle {
    border: 1.5px solid #35C10D;
    border-radius: 1.5rem 1.5rem 0 0;
}
.custom-select-container.show .custom-select-label {
    color: #35C10D;
}
.custom-select-container .filter-not-found {
    padding: 3px;
    background: #f5f5f5;
    margin: 0 5px;
    white-space: nowrap;
}
.custom-select-container .selected:after {
    content: '';
    width: 0.5em;
    height: 1em;
    border-style: solid;
    border-width: 0 0.26em 0.26em 0;
    -webkit-transform: rotate(45deg);
    -ms-transform: rotate(45deg) scale(0.75);
    -o-transform: rotate(45deg) scale(0.75);
    transform: rotate(45deg) scale(0.75);
    position: absolute;
    right: 16px;
    color: #35c10d;
}

    </style>
    <script>
       (function ($) {
    $.fn.customSelect = function () {
        return this.each(function () {
            var $selectBox = $(this);

            var texts = {
                chooseOptions: $selectBox.data('text-choose-options') || 'Choose options',
                noResults: $selectBox.data('text-no-results') || 'No results matched',
                deselectAll: $selectBox.data('text-deselect-all') || 'Deselect All',
                selectAll: $selectBox.data('text-select-all') || 'Select All',
                search: $selectBox.data('text-search') || 'Search...',
                label: $selectBox.data('text-label') || 'Select Name',
                itemSelected: $selectBox.data('text-items-selected') || 'items selected'
            };

            var isMultiple = $selectBox.prop('multiple');
            var isActionsBox = $selectBox.data('actions-box') === true;
            var isSearch = $selectBox.data('live-search') === true;
            var countSelectedText = $selectBox.data('count-selected-text');
            var $dropdownToggle = $('<div class="custom-select-toggle"></div>');
            var $dropdownLabel = $('<label class="custom-select-label">' + texts.label + '</label>');
            var $dropdownMenu = $('<div class="custom-select-menu"></div>');
            var $customSelectContainer = $('<div class="custom-select-container"></div>');
            var $additionalContainer = $('<div class="additional-container"></div>');
            var $itemContainer = $('<ul class="item-container"></ul>');
            var $filterContainer = $('<div class="filter-container"><input type="text" class="filter-input" placeholder="' + texts.search + '"></div>');
            var $actionButtons = $('<div class="action-buttons"><button class="select-all">' + texts.selectAll + '</button><button class="deselect-all">' + texts.deselectAll + '</button></div>');
            var $notFoundMessage = $('<div class="filter-not-found">' + texts.noResults + ' "<span class="search-keyword"></span>"</div>');

            function init() {
                setupDropdown();
                setupEventHandlers();
                updateDropdownText();

                $selectBox.on('change', function () {
                    updateDropdownText();
                });
            }

            function setupDropdown() {
                $selectBox.hide();

                $dropdownToggle.html(getSelectedText() || texts.chooseOptions);

                $customSelectContainer.append($dropdownLabel);
                $customSelectContainer.append($dropdownToggle, $dropdownMenu);
                $dropdownMenu.append($additionalContainer);

                if (isSearch) {
                    $additionalContainer.append($filterContainer);
                }
                if (isMultiple && isActionsBox) {
                    $additionalContainer.append($actionButtons);
                    $actionButtons.find('.select-all, .deselect-all').show();
                }

                $selectBox.after($customSelectContainer);

                buildDropdownOptions();
            }

            function buildDropdownOptions() {
                $selectBox.find('option').each(function () {
                    var $option = $(this);
                    var $listItem = $('<li>' + $option.html() + '</li>');

                    // Eğer data-img özelliği tanımlıysa ve değeri boş değilse
                    if ($option.data('img') && $option.data('img').trim() !== '') {
                        var $img = $('<img src="' + $option.data('img') + '">');
                        var imgWidth = $option.data('img-width') ? $option.data('img-width') : '30px';
                        var imgHeight = $option.data('img-height') ? $option.data('img-height') : '30px';
                        $img.css({
                            width: imgWidth,
                            height: imgHeight
                        });
                        $listItem.prepend($img);
                    }

                    $listItem.on('click', function () {
                        handleOptionClick($option, $listItem);
                    });

                    if ($option.prop('selected')) {
                        if (isMultiple) {
                            $listItem.addClass('selected');
                        } else {
                            $listItem.addClass('active');
                        }
                    }
                    $itemContainer.append($listItem);
                    $dropdownMenu.append($itemContainer);
                });
            }


            function setupEventHandlers() {
                $filterContainer.find('.filter-input').on('input', function () {
                    filterOptions($(this).val());
                });

                $actionButtons.find('.select-all').on('click', function () {
                    selectAllOptions();
                    updateDropdownText();
                });

                $actionButtons.find('.deselect-all').on('click', function () {
                    deselectAllOptions();
                    updateDropdownText();
                });

                $dropdownToggle.on('click', function () {
                    toggleDropdownMenu();
                });

                $(document).on('click', function (event) {
                    handleDocumentClick(event);
                });

                $dropdownToggle.on('blur', function () {
                    clearSearchInput();
                });
            }

            function handleOptionClick($option, $listItem) {
                if (!isMultiple) {
                    $dropdownMenu.hide();
                }
                if (isMultiple) {
                    $option.prop('selected', !$option.prop('selected'));
                    $listItem.toggleClass('selected', $option.prop('selected'));
                } else {
                    $selectBox.val($option.val());
                    $listItem.siblings().removeClass('active');
                    $listItem.addClass('active');
                }

                $selectBox.trigger('change');
            }

            function handleDocumentClick(event) {
                if (!$dropdownToggle.is(event.target) &&
                    !$dropdownMenu.is(event.target) &&
                    $dropdownMenu.has(event.target).length === 0
                ) {
                    $customSelectContainer.removeClass('show');
                    $dropdownMenu.hide();
                    clearSearchInput();
                    filterOptions('');
                }
            }

            function toggleDropdownMenu() {
                $dropdownMenu.toggle();
                $customSelectContainer.toggleClass('show');
                if ($filterContainer.find('.filter-input').is(':visible')) {
                    $filterContainer.find('.filter-input').focus();
                }
            }

            function clearSearchInput() {
                $filterContainer.find('.filter-input').val('');
                filterOptions('');
            }

            function updateDropdownText() {
                var selectedCount = getSelectedCount();
                var selectedText =
                    selectedCount > countSelectedText ? selectedCount + ' ' + texts.itemSelected : getSelectedText();

                if (!isMultiple) {
                    var selectedIndex = $selectBox.prop('selectedIndex');
                    $itemContainer.find('li').removeClass('active');
                    $itemContainer.find('li').eq(selectedIndex).addClass('active');
                    $customSelectContainer.removeClass('show');
                }
                var $selectedImages = $dropdownMenu.find('.active img').clone();
                $selectedImages.addClass('selected-image');

                if ($selectBox.data('show-selected-image') === true) {
                    var $selectedImages = $dropdownMenu.find('.active img').clone();
                    $selectedImages.addClass('selected-image');
                    $dropdownToggle.empty().append($selectedImages, selectedText || texts.chooseOptions);
                } else {
                    $dropdownToggle.text(selectedText || texts.chooseOptions);
                }
            }

            function getSelectedCount() {
                return $selectBox.find('option:selected').length;
            }

            function filterOptions(searchTerm) {
                var $filteredItems = $dropdownMenu.find('li:containsi(' + searchTerm + ')');

                if ($filteredItems.length === 0 && searchTerm !== '') {
                    $notFoundMessage.find('.search-keyword').text(searchTerm);
                    $dropdownMenu.append($notFoundMessage);

                    if (isActionsBox) {
                        $actionButtons.hide();
                    }
                } else {
                    $notFoundMessage.remove();
                    if (isActionsBox) {
                        $actionButtons.show();
                    }
                }

                $dropdownMenu.find('li').hide();
                $filteredItems.show();
            }

            function selectAllOptions() {
                $selectBox.find('option').prop('selected', true);
                if (isMultiple) {
                    $dropdownMenu.find('li').addClass('selected');
                } else {
                    $dropdownMenu.find('li').addClass('active');
                }
                $selectBox.trigger('change');
            }

            function deselectAllOptions() {
                $selectBox.find('option').prop('selected', false);
                if (isMultiple) {
                    $dropdownMenu.find('li').removeClass('selected');
                } else {
                    $dropdownMenu.find('li').removeClass('active');
                }
                $selectBox.trigger('change');
            }

            function getSelectedText() {
                var selectedOptions = $selectBox.find('option:selected');
                return selectedOptions
                    .map(function () {
                        return $(this).text();
                    })
                    .get()
                    .join(', ');
            }

            $.expr[":"].containsi = $.expr.createPseudo(function (arg) {
                return function (elem) {
                    return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) >= 0;
                };
            });

            init();
        });
    };
})(jQuery);

        $(document).ready(function() {
            $('.selectpicker').customSelect();
        });
    </script>
</head>

<body>
<select class="selectpicker" data-count-selected-text="5" data-live-search="true" data-actions-box="true"
        data-text-choose-options="Custom Choose Options"
        data-text-no-results="Custom No Results"
        data-text-deselect-all="Custom Deselect All"
        data-text-select-all="Custom Select All"
        data-text-search="Custom Search..."
        data-text-items-selected="Custom items Selected"
        data-show-selected-image="true"
        multiple>
    <option selected>Example</option>
    <option selected>Ketchup</option>
    <option selected>Relish</option>
    <option selected>Mayonnaise</option>
    <option data-img="https://upload.wikimedia.org/wikipedia/commons/a/ac/Approve_icon.svg" data-img-width="30px" data-img-height="30px">Hot Sauce</option>
    <option>BBQ Sauce</option>
    <option>Soy Sauce</option>
</select>

</body>

</html>
